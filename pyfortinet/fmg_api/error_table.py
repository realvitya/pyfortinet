"""FMG API Error Table"""

from copy import copy
from typing import Union, Optional, Type
import re

from pyfortinet.exceptions import *


def get_fmg_error(error_code: Union[str, int]) -> Optional[Union[Type[FMGException], str]]:
    """FMG API error code lookup

    Args:
        error_code (int): FMG error code

    Returns:
         FMGException: Exception class. None if error not found.

    Examples:
        error_code = 11
        returns: FMGAuthenticationException
    """
    error_code = abs(int(error_code))  # standardize error code to positive int
    return API_ERRORS[error_code] if error_code in API_ERRORS else "Undocumented error"


API_ERRORS = {
    # from experiments / undocumented
    9891: "insufficient licenses",  # got by cloning adom. text is visible on gui cloning log.
    # from documentation
    0: "OK",
    1: "Unknown error",
    2: FMGObjectAlreadyExistsException,  # "Object already exists",
    3: "Object does not exist",
    4: "Could not resolve reference",
    5: "No such command",
    6: FMGInvalidURL,  # "Invalid url",
    7: "Invalid option",
    8: "Invalid parameter",
    9: "The command is invalid for selected url",
    10: FMGInvalidDataException,  # "The data is invalid for selected url",
    11: FMGAuthenticationException,  # "No permission for the resource",
    12: "Target cannot be connected",
    13: "Data is not ready",
    14: "No workflow session permission",
    15: "Device is not in a backup mode ADOM",
    16: "ADOM version mismatch",
    17: "ADOM type mismatch",
    18: "there exists unapproved workflow session",
    19: "Could not retrieve session info",
    20: "Parent object does not exist",
    21: "Scope does not exist",
    22: "Login fail",
    23: "Reach login limit",
    24: "Timeout",
    25: "Value of meta field is too long",
    26: "Object are not supported",
    27: "Duplicate request",
    10000: "invalid value",
    10001: "entry exists",
    10002: "invalid ip",
    10003: "max entry",
    10004: "sslvpn policy srcintf https",
    10005: "out of range",
    10006: "dhcp relay conflict",
    10007: "invalid vlan id",
    10008: "invalid interface",
    10009: "empty value",
    10010: "tunnel remote ip",
    10011: "tunnel local ip",
    10012: "illegal name",
    10013: "vlan name same as vdom",
    10014: "intf error mode",
    10015: "used",
    10016: "same subnet",
    10017: "unexpected input",
    10018: "same peer/local ID",
    10019: "invalid ip range",
    10020: "interface binding contradiction",
    10021: "duplicate remote gateway",
    10022: "internal error",
    10023: "beyond the boundary",
    10024: "invalid setting",
    10025: "empty user group",
    10026: "user group not exist",
    10027: "invalid ips data",
    10028: "system error",
    10029: "invalid auth key",
    10030: "invalid enc key",
    10031: "null ipsec transform",
    10032: "invalid dev index",
    10033: "duplicate",
    10034: "svrgrp",
    10035: "fortianalyzer server unavailable",
    10036: "invalid port number",
    10037: "start ip is larger",
    10038: "invalid ip range",
    10039: "pptp/l2tp overlap",
    10040: "tunnel not exist",
    10041: "not dialup tunnel",
    10042: "entry not exist",
    10043: "no radius user",
    10044: "address",
    10045: "dhcp server conflict",
    10046: "dhcp interface not static",
    10047: "dhcp server subnet conflict",
    10048: "dhcp lease time",
    10049: "invalid ftgd category",
    10050: "At least one SSL VPN web application needs to be enabled",
    10051: "invalid duration",
    10052: "fortilog ip",
    10053: "fortilog in use",
    10054: "conflict value",
    10055: "Cannot enable https redirect because forticlient-check is enabled in some policy",
    10056: "Interfaces must have the same forward domain ID in TP mode",
    10057: "invalid mask",
    10058: "addr/addrgrp conflict",
    10059: "invalid mac",
    10060: "ippool in use",
    10061: "ippool overlap",
    10062: "not multicast addr",
    10063: "addr name",
    10064: "service name",
    10065: "schedule name",
    10066: "policy bandwidth",
    10067: "tunnel name",
    10068: "empty avprofile",
    10069: "invalid ftgd ovrd domain",
    10070: "invalid date/time",
    10071: "no question mark",
    10072: "time/date",
    10073: "threshold greater than limit",
    10074: "no BSR interface",
    10075: "no source override interface",
    10076: "interval less than response",
    10077: "invalid number",
    10078: "value too long",
    10079: "invalid interface",
    10080: "change vlan info",
    10081: "cannot modify",
    10082: "wireless mode",
    10083: "cannot be deleted",
    10084: "cannot change vdom for tunnel interface",
    10085: "cannot delete local gateway in gre-tunnel",
    10086: "cannot delete remote gateway in gre-tunnel",
    10087: "conflict with system",
    10088: "could not delete the last rule in this list",
    10089: "duplicate ip in the list",
    10090: "duplicate monitors found",
    10091: "error password",
    10092: "gwdetect should be disabled",
    10093: "hello hold too low",
    10094: "interface is being used",
    10095: "interface name cannot start with space",
    10096: "invalid ftgd auth port",
    10097: "invalid gateway",
    10098: "invalid profile name",
    10099: "invalid value(key should be only one line)",
    10100: "name is too long",
    10101: "no entry found in system interface",
    10102: "not a local user",
    10103: "port number is used",
    10104: "too many interfaces",
    10105: "too many monitors",
    10106: "used by system, cannot be deleted",
    10107: "user group name",
    10108: "user group type",
    10109: "insufficient licenses",
    10110: "invalid holddown interval",
    10111: "destinations of firewall policy contain IP address range",
    10112: "destinations of firewall policy contain IP address 0.0.0.0",
    10113: "xauthtype can not be client while remote gateway is dialup",
    10114: "the application-list must be set",
    10115: "Cannot enable forticlient-check because authentication is redirected to https",
    10116: "Transparent mode FGT can not have sslvpn type user group",
    10117: "Destination address of split tunneling policy is invalid",
    10118: "Maximum 8 heartbeat interfaces are allowed",
    10119: "Syslog server/port can't be empty",
    10120: "Please configure primary IP address first",
    10121: "Please remove virtual AP interfaces before switching out of AP mode.",
    10122: "wireless interface reach to MAX",
    10123: "Policy id space out of range",
    10124: "endpoint profile missing",
    10125: "cannot quarantine",
    10126: "The string contains XSS vulnerability characters",
    10127: "HA configuration is not allowed to be changed in HA mode",
    10128: FMGLockException,  # "ADOM is locked",
    10129: "Policy folder is not empty",
    10130: "Policy package was assigned to adom",
    10131: "datasrc invalid",
    10132: "prune adom failed",
    10133: "The archive value is invalid",
    10134: "Per-ip shaper: DSCP value must be 6 bits binary, range 000000-111111",
    10135: "Could not change assigned objs",
    10136: "duplicate ips custom tag name",
    10137: "duplicate ips custom signature name",
    10138: "zone map member has been used by another mapping",
    10139: "cannot be edited",
    10140: "cannot be added",
    10141: "cannot be unset",
    10142: "the zone has multiple mappings in devices",
    10143: "the zone has been set on firewall vip, vipgroup, or gtp",
    10144: "invalid sequence number",
    10145: "vdom of system interface is in ha secondary-vcluster",
    10146: "no central-management ip configured for this device",
    10147: FMGLockNeededException,  # "no write permission",
    10148: FMGLockNeededException,  # "lock local/global adom then try again",
    10149: FMGDataSrcDuplicateException,  # "datasrc duplicate",
    10150: "vip overlap",
    10151: "there is no value in the entry, need to set value or dynamic mapping",
    10152: "dynamic-interface default mapping has been used",
    10153: "Mapping or default mapping not exist",
    10154: "The interface has been used by a zone",
    10155: "parameter(s) invalid",
    10156: "cannot be empty",
    10157: "default mapping is not enabled for this object",
    10158: "Global adom package CNAT is not consistent with local adom package CNAT",
    10159: "Global adom package inspection mode is not consistent with local adom package inspection mode",
    10160: "ADOM package inspection mode is not consistent with its target VDOM inspection mode",
    10161: "Can not delete used objects",
    10162: "Can not rename objects when policy package locked",
    10163: "No access permission",
    10164: "Install target(s) invalid",
    10165: "Policy block invalid",
    10166: "No nested policy blocks",
    10167: "Package setting mismatch",
    10168: "Invalid serial number for FortiAnalyzer",
    10169: "Adom object is used by device",
    10170: "Package copy failed",
    10171: "Operation not supported",
    10172: "duplicate server ip",
    10173: "empty meta",
    10174: "firmware mismatch",
    10175: "invalid template assignment",
    10176: "No IPS object permission",
    10177: "value cannot be explicitly set",
    10178: "setting cannot be modified on FortiGate-CNF device",
    10179: "Invalid vdom context",
    20000: "OK",
    20001: "Internal error",
    20002: "Invalid argument",
    20003: "Initialization failed",
    20004: "Not exist",
    20005: "Import failed",
    20006: "Checkout failed",
    20007: "Reload failed",
    20008: "Name already in use",
    20009: "IP already in use",
    20010: "Serial number already in use",
    20011: "No service",
    20012: "Unregistered device ignored",
    20013: "Object is in use",
    20014: "Not a member",
    20015: "Probe failed",
    20016: "Insufficient number of licenses",
    20017: FMGLockNeededException,  # "Lock reqired",
    20018: "Locked",
    20019: "Out of range",
    20020: FMGLockNeededException,  # "No permission",
    20021: "Already managed",
    20022: "Unsupported operation",
    20023: "Unsupported device model",
    20024: "Unsupported device os type",
    20025: "Unsupported device/ADOM version",
    20026: "Unsupported device model",
    20027: "Group cannot be nested more than 2 levels",
    20028: "Reached limit",
    20029: "Name cannot be blank",
    20030: "Invalid name",
    20031: "Serial number does not match device model",
    20032: "Device serial number does not match database",
    20033: "Command failed",
    20034: "Address unknown",
    20035: "Already exists",
    20036: FMGLockException,  # "ADOM is locked",
    20037: "Device cannot be managed through HA management interface",
    20038: "Probe failed: device is offline",
    20039: "Probe failed: certificate mismatch",
    20040: "Probe failed: encryption mismatch",
    20041: "Cannot add device type to this ADOM",
    20042: "Probe failed: network",
    20043: "Probe failed: login error",
    20044: "Please save ADOM change(s) first",
    20045: "Workflow session state error",
    20046: "Approval failed as there are prior sessions in queue. Please review them first.",
    20047: "Update workflow data failed",
    20048: "Unknown DVM error",
    20049: "Workflow approval matrix required",
    20050: "Duplicate workflow action",
    20051: "Workflow session limit reached",
    20052: "Unable to perform the requested action. The session might have been discarded or removed.",
    20053: "Unknown DVM error",
    20054: "Internal error for workspace action",
    20055: FMGLockException,  # "Workspace is locked by other user",
    20056: "SQLITE error for workspace action",
    20057: "Open database failed for workspace action",
    20058: "invalid session for workspace action",
    20059: "copy database failed for workspace action",
    20060: "lock package failed for workspace action",
    20061: "Invalid data for workspace action",
    20062: "Number of the script for the selected type has reached the max. No more script is allowed for this type",
    20063: "Unable to delete because ADOM is not empty",
    20064: "Unable to delete because the adom is in global assignment list or is referenced by a defined admin account",
    20065: "Unable to add FAZ because the adom mode is advanced",
    20066: "Unable to add FAZ because FAZ status is enabled",
    20067: "Pre-shared key already exists",
    20068: "Unable to delete device group because it is used by admin",
    20069: "Name cannot exceed 48 characters",
    20070: "Cannot delete a default meta field",
    20071: "ADOM clone failed",
    20072: "This FortiGate does not have central management subscription to FortiManager-Cloud",
    20073: "Per-policy lock is disabled",
    20074: "commit failed for workspace action",
    20075: "Cluster master is not being managed",
    20076: "Unable to delete because it is used by blueprint",
    20077: "Sync to FAZ failed",
    20078: "lock conflict with other type of locks",
    20079: "There is not write permission",
    20080: "Replace SN to FAZ failed",
    20081: "Failed to delete object member",
    60000: "CFG_OK",
    60001: "value too long",
    60002: "out of range",
    60003: "entry not exist",
    60004: "max entry",
    60005: "entry exists",
    60006: "malloc failed",
    60007: "conflict value",
    60008: "invalid ip",
    60009: "invalid mask",
    60010: "invalid gateway",
    60014: "no privilege",
    60015: "duplicate",
    60016: "address",
    60018: "invalid service",
    60023: "used",
    60024: "open",
    60025: "memory",
    60026: "file",
    60027: "file/network device statistics",
    60029: "user can not be deleted when it is logged in",
    60030: "login",
    60031: "password",
    60033: "invalid mac",
    60037: "no permission",
    60038: "download",
    60039: "invalid setting",
    60045: "invalid ip range",
    60050: "bad format",
    60056: "empty value",
    60057: "String contains invalid character(s)",
    60061: "unexpected input",
    60065: "untar failed",
    60066: "gunzip failed",
    60067: "can not create tmp directory",
    60086: "incorrect upload file",
    60089: "invalid number",
    60093: "connection",
    60130: "time/date",
    60131: "time/year",
    60132: "time/month",
    60133: "time/day",
    60134: "time/time",
    60135: "time/hour",
    60136: "time/minute",
    60137: "time/second",
    60145: "import local certificate",
    60146: "import ca certificate",
    60147: "delete certificate",
    60149: "empty user group",
    60151: "certificate does not exist",
    60152: "invalid enc key",
    60153: "invalid auth key",
    60160: "generic",
    60166: "name is too long",
    60175: "log file size",
    60203: "ip is blocked",
    60204: "password",
    60205: "password is empty",
    60206: "user profile",
    60252: "invalid port",
    60253: "remote sql log disable",
    60254: "remote sql log enable",
    60360: "cmdb command timeout",
    60361: "cmdb add entry failed",
    60515: "match duplication or reservation",
    60542: "import certificate revocation list",
    60550: "import SSH certificate",
    60551: "import SSH private key",
    60650: "beyond the limited range",
    60651: "invalid value",
    60801: "admin profile is in use",
    60802: "default admin profile",
    60803: "default admin meta data",
    60804: "Only super users can edit/create administrators",
    60805: "Only super users can delete administrators",
    60806: "Only super users can edit/create administrators with super user profile",
    60807: "Only super users can change ADOM permissions",
    60901: "backup failed",
    60902: "restore failed",
    60920: "Need to register to FortiCloud",
    60930: "Failed to sync user to FortiToken Cloud",
    60950: "Docker network conflicts with an interface",
    60951: "Missing docker",
    60952: "Invalid docker",
    60953: "Docker is not enabled",
    60954: "Internal error",
    60955: "Can't pull new image",
    60956: "Can't start new image",
    61002: "internal",
    61005: "access is denied",
    61174: "remote ip is same as local ip",
    61175: "aggregation server is same as local ip",
    61651: "no enough disk space",
    61652: "fetch log session exists",
    62038: "device is invalid",
    64000: "add entry failed",
    64001: "del entry failed",
    64015: "import file is invalid",
    64018: "import device is mismatched",
    65002: "log device quota is less than minimum required quota",
    65006: "can not find unregister log device",
    65007: "can not find log device",
    65010: "log rolling size is beyond limit",
    65100: "bad name",
    65203: "report language format file is invalid",
    65204: "report language string file is invalid",
    65205: "report language format file error",
    65206: "report language string file error",
    65210: "add report language failed",
    65300: "faz upload daemon connection failed",
    65301: "faz upload daemon session failed",
    65302: "faz upload daemon authentication failed",
    65303: "faz upload daemon uploads file failed",
    67450: "number of devices reaches license limit",
    67465: "device type is not supported",
    67467: "device allocated space exceeds the total limit",
    67653: "no more space for device auto register",
    67800: "device id is invalid",
    67801: "blocked by configuration",
    67802: "connection is ignored",
    67803: "device is added as an unregister device",
    67804: "invalid date/time",
    67805: "the expiry date must be in the future",
}
